
clear
clc

%%
traj = 2;        % 1 - fourier, 2 - park
opt = 1;         % 1 - fmincon, -1 - ga, 0 - both

if traj == 1
    
    fcn = @fcn_fourier;
    const = @(x) constraints(x, "fourier");
    numberofvariables = 61;
    load f_initialguesses.mat   % I renamed the file generated by 'many_initial_guesses.m'
    
elseif traj == 2
        
    fcn = @fcn_park;
    const = @(x) constraints(x, "park");
    numberofvariables = 50;
    load p_initialguesses.mat   % I renamed the file generated by 'many_initial_guesses.m'
    
end
%% fmincon

if opt >= 0
    
    options = optimoptions(@fmincon, 'Display', 'iter', ...
        'Algorithm', 'interior-point', 'MaxIterations', 1000, ...
        'MaxFunctionEvaluations', 100000,'UseParallel',true);
    
    if max(size(gcp)) == 0 % parallel pool needed
        parpool % create the parallel pool
    end

    tic
    [x, fval] = fmincon(fcn,best_xs(:,end),[],[],[],[],[],[],const, options);
    toc

    save done.mat
    fval

end

%% ga

if opt <= 0

    options = optimoptions('ga','InitialPopulationMatrix',best_xs,'FunctionTolerance',1e-6,'PopulationSize',50,'MaxGenerations',500, 'Display', 'iter');
    tic
    [x,fval] = ga(fcn,numberofvariables,[],[],[],[],[],[],const,options);
    toc

    save done_ga.mat
    fval

end
